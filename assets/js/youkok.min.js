!function(a){var b={isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return"undefined"==typeof a},bind:a.proxy,each:function(b,c){function d(a,b){return c(b,a)}a.each(b,d)},map:a.map,filter:a.grep,every:function(b,c){var d=!0;return b?(a.each(b,function(a,e){return(d=c.call(null,e,a,b))?void 0:!1}),!!d):d},some:function(b,c){var d=!1;return b?(a.each(b,function(a,e){return(d=c.call(null,e,a,b))?!1:void 0}),!!d):d},mixin:a.extend,getUniqueId:function(){var a=0;return function(){return a++}}(),templatify:function(b){function c(){return String(b)}return a.isFunction(b)?b:c},defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var f,g,h=this,i=arguments;return f=function(){d=null,c||(e=a.apply(h,i))},g=c&&!d,clearTimeout(d),d=setTimeout(f,b),g&&(e=a.apply(h,i)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},noop:function(){}},c="0.10.2",d=function(){function a(a){return a.split(/\s+/)}function b(a){return a.split(/\W+/)}function c(a){return function(b){return function(c){return a(c[b])}}}return{nonword:b,whitespace:a,obj:{nonword:c(b),whitespace:c(a)}}}(),e=function(){function a(a){this.maxSize=a||100,this.size=0,this.hash={},this.list=new c}function c(){this.head=this.tail=null}function d(a,b){this.key=a,this.val=b,this.prev=this.next=null}return b.mixin(a.prototype,{set:function(a,b){var c,e=this.list.tail;this.size>=this.maxSize&&(this.list.remove(e),delete this.hash[e.key]),(c=this.hash[a])?(c.val=b,this.list.moveToFront(c)):(c=new d(a,b),this.list.add(c),this.hash[a]=c,this.size++)},get:function(a){var b=this.hash[a];return b?(this.list.moveToFront(b),b.val):void 0}}),b.mixin(c.prototype,{add:function(a){this.head&&(a.next=this.head,this.head.prev=a),this.head=a,this.tail=this.tail||a},remove:function(a){a.prev?a.prev.next=a.next:this.head=a.next,a.next?a.next.prev=a.prev:this.tail=a.prev},moveToFront:function(a){this.remove(a),this.add(a)}}),a}(),f=function(){function a(a){this.prefix=["__",a,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+this.prefix)}function c(){return(new Date).getTime()}function d(a){return JSON.stringify(b.isUndefined(a)?null:a)}function e(a){return JSON.parse(a)}var f,g;try{f=window.localStorage,f.setItem("~~~","!"),f.removeItem("~~~")}catch(h){f=null}return g=f&&window.JSON?{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},get:function(a){return this.isExpired(a)&&this.remove(a),e(f.getItem(this._prefix(a)))},set:function(a,e,g){return b.isNumber(g)?f.setItem(this._ttlKey(a),d(c()+g)):f.removeItem(this._ttlKey(a)),f.setItem(this._prefix(a),d(e))},remove:function(a){return f.removeItem(this._ttlKey(a)),f.removeItem(this._prefix(a)),this},clear:function(){var a,b,c=[],d=f.length;for(a=0;d>a;a++)(b=f.key(a)).match(this.keyMatcher)&&c.push(b.replace(this.keyMatcher,""));for(a=c.length;a--;)this.remove(c[a]);return this},isExpired:function(a){var d=e(f.getItem(this._ttlKey(a)));return b.isNumber(d)&&c()>d?!0:!1}}:{get:b.noop,set:b.noop,remove:b.noop,clear:b.noop,isExpired:b.noop},b.mixin(a.prototype,g),a}(),g=function(){function c(b){b=b||{},this._send=b.transport?d(b.transport):a.ajax,this._get=b.rateLimiter?b.rateLimiter(this._get):this._get}function d(c){return function(d,e){function f(a){b.defer(function(){h.resolve(a)})}function g(a){b.defer(function(){h.reject(a)})}var h=a.Deferred();return c(d,e,f,g),h}}var f=0,g={},h=6,i=new e(10);return c.setMaxPendingRequests=function(a){h=a},c.resetCache=function(){i=new e(10)},b.mixin(c.prototype,{_get:function(a,b,c){function d(b){c&&c(null,b),i.set(a,b)}function e(){c&&c(!0)}function j(){f--,delete g[a],l.onDeckRequestArgs&&(l._get.apply(l,l.onDeckRequestArgs),l.onDeckRequestArgs=null)}var k,l=this;(k=g[a])?k.done(d).fail(e):h>f?(f++,g[a]=this._send(a,b).done(d).fail(e).always(j)):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(a,c,d){var e;return b.isFunction(c)&&(d=c,c={}),(e=i.get(a))?b.defer(function(){d&&d(null,e)}):this._get(a,c,d),!!e}}),c}(),h=function(){function c(b){b=b||{},b.datumTokenizer&&b.queryTokenizer||a.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=b.datumTokenizer,this.queryTokenizer=b.queryTokenizer,this.reset()}function d(a){return a=b.filter(a,function(a){return!!a}),a=b.map(a,function(a){return a.toLowerCase()})}function e(){return{ids:[],children:{}}}function f(a){for(var b={},c=[],d=0;d<a.length;d++)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return c}function g(a,b){function c(a,b){return a-b}var d=0,e=0,f=[];for(a=a.sort(c),b=b.sort(c);d<a.length&&e<b.length;)a[d]<b[e]?d++:a[d]>b[e]?e++:(f.push(a[d]),d++,e++);return f}return b.mixin(c.prototype,{bootstrap:function(a){this.datums=a.datums,this.trie=a.trie},add:function(a){var c=this;a=b.isArray(a)?a:[a],b.each(a,function(a){var f,g;f=c.datums.push(a)-1,g=d(c.datumTokenizer(a)),b.each(g,function(a){var b,d,g;for(b=c.trie,d=a.split("");g=d.shift();)b=b.children[g]||(b.children[g]=e()),b.ids.push(f)})})},get:function(a){var c,e,h=this;return c=d(this.queryTokenizer(a)),b.each(c,function(a){var b,c,d,f;if(e&&0===e.length)return!1;for(b=h.trie,c=a.split("");b&&(d=c.shift());)b=b.children[d];return b&&0===c.length?(f=b.ids.slice(0),void(e=e?g(e,f):f)):(e=[],!1)}),e?b.map(f(e),function(a){return h.datums[a]}):[]},reset:function(){this.datums=[],this.trie=e()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),c}(),i=function(){function d(a){return a.local||null}function e(d){var e,f;return f={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(e=d.prefetch||null)&&(e=b.isString(e)?{url:e}:e,e=b.mixin(f,e),e.thumbprint=c+e.thumbprint,e.ajax.type=e.ajax.type||"GET",e.ajax.dataType=e.ajax.dataType||"json",!e.url&&a.error("prefetch requires url to be set")),e}function f(c){function d(a){return function(c){return b.debounce(c,a)}}function e(a){return function(c){return b.throttle(c,a)}}var f,g;return g={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(f=c.remote||null)&&(f=b.isString(f)?{url:f}:f,f=b.mixin(g,f),f.rateLimiter=/^throttle$/i.test(f.rateLimitBy)?e(f.rateLimitWait):d(f.rateLimitWait),f.ajax.type=f.ajax.type||"GET",f.ajax.dataType=f.ajax.dataType||"json",delete f.rateLimitBy,delete f.rateLimitWait,!f.url&&a.error("remote requires url to be set")),f}return{local:d,prefetch:e,remote:f}}();!function(c){function e(b){b&&(b.local||b.prefetch||b.remote)||a.error("one of local, prefetch, or remote is required"),this.limit=b.limit||5,this.sorter=j(b.sorter),this.dupDetector=b.dupDetector||k,this.local=i.local(b),this.prefetch=i.prefetch(b),this.remote=i.remote(b),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new h({datumTokenizer:b.datumTokenizer,queryTokenizer:b.queryTokenizer}),this.storage=this.cacheKey?new f(this.cacheKey):null}function j(a){function c(b){return b.sort(a)}function d(a){return a}return b.isFunction(a)?c:d}function k(){return!1}var l,m;return l=c.Bloodhound,m={data:"data",protocol:"protocol",thumbprint:"thumbprint"},c.Bloodhound=e,e.noConflict=function(){return c.Bloodhound=l,e},e.tokenizers=d,b.mixin(e.prototype,{_loadPrefetch:function(b){function c(a){f.clear(),f.add(b.filter?b.filter(a):a),f._saveToStorage(f.index.serialize(),b.thumbprint,b.ttl)}var d,e,f=this;return(d=this._readFromStorage(b.thumbprint))?(this.index.bootstrap(d),e=a.Deferred().resolve()):e=a.ajax(b.url,b.ajax).done(c),e},_getFromRemote:function(a,b){function c(a,c){b(a?[]:f.remote.filter?f.remote.filter(c):c)}var d,e,f=this;return a=a||"",e=encodeURIComponent(a),d=this.remote.replace?this.remote.replace(this.remote.url,a):this.remote.url.replace(this.remote.wildcard,e),this.transport.get(d,this.remote.ajax,c)},_saveToStorage:function(a,b,c){this.storage&&(this.storage.set(m.data,a,c),this.storage.set(m.protocol,location.protocol,c),this.storage.set(m.thumbprint,b,c))},_readFromStorage:function(a){var b,c={};return this.storage&&(c.data=this.storage.get(m.data),c.protocol=this.storage.get(m.protocol),c.thumbprint=this.storage.get(m.thumbprint)),b=c.thumbprint!==a||c.protocol!==location.protocol,c.data&&!b?c.data:null},_initialize:function(){function c(){e.add(b.isFunction(f)?f():f)}var d,e=this,f=this.local;return d=this.prefetch?this._loadPrefetch(this.prefetch):a.Deferred().resolve(),f&&d.done(c),this.transport=this.remote?new g(this.remote):null,this.initPromise=d.promise()},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){this.index.add(a)},get:function(a,c){function d(a){var d=f.slice(0);b.each(a,function(a){var c;return c=b.some(d,function(b){return e.dupDetector(a,b)}),!c&&d.push(a),d.length<e.limit}),c&&c(e.sorter(d))}var e=this,f=[],g=!1;f=this.index.get(a),f=this.sorter(f).slice(0,this.limit),f.length<this.limit&&this.transport&&(g=this._getFromRemote(a,d)),g||(f.length>0||!this.transport)&&c&&c(f)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&g.resetCache()},ttAdapter:function(){return b.bind(this.get,this)}}),e}(this);var j={wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'},k={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"text-rendering",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};b.isMsie()&&b.mixin(k.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),b.isMsie()&&b.isMsie()<=7&&b.mixin(k.input,{marginTop:"-1px"});var l=function(){function c(b){b&&b.el||a.error("EventBus initialized without el"),this.$el=a(b.el)}var d="typeahead:";return b.mixin(c.prototype,{trigger:function(a){var b=[].slice.call(arguments,1);this.$el.trigger(d+a,b)}}),c}(),m=function(){function a(a,b,c,d){var e;if(!c)return this;for(b=b.split(i),c=d?h(c,d):c,this._callbacks=this._callbacks||{};e=b.shift();)this._callbacks[e]=this._callbacks[e]||{sync:[],async:[]},this._callbacks[e][a].push(c);return this}function b(b,c,d){return a.call(this,"async",b,c,d)}function c(b,c,d){return a.call(this,"sync",b,c,d)}function d(a){var b;if(!this._callbacks)return this;for(a=a.split(i);b=a.shift();)delete this._callbacks[b];return this}function e(a){var b,c,d,e,g;if(!this._callbacks)return this;for(a=a.split(i),d=[].slice.call(arguments,1);(b=a.shift())&&(c=this._callbacks[b]);)e=f(c.sync,this,[b].concat(d)),g=f(c.async,this,[b].concat(d)),e()&&j(g);return this}function f(a,b,c){function d(){for(var d,e=0;!d&&e<a.length;e+=1)d=a[e].apply(b,c)===!1;return!d}return d}function g(){var a;return a=window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}function h(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,0))}}var i=/\s+/,j=g();return{onSync:c,onAsync:b,off:d,trigger:e}}(),n=function(a){function c(a,c,d){for(var e,f=[],g=0;g<a.length;g++)f.push(b.escapeRegExChars(a[g]));return e=d?"\\b("+f.join("|")+")\\b":"("+f.join("|")+")",c?new RegExp(e):new RegExp(e,"i")}var d={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(e){function f(b){var c,d;return(c=h.exec(b.data))&&(wrapperNode=a.createElement(e.tagName),e.className&&(wrapperNode.className=e.className),d=b.splitText(c.index),d.splitText(c[0].length),wrapperNode.appendChild(d.cloneNode(!0)),b.parentNode.replaceChild(wrapperNode,d)),!!c}function g(a,b){for(var c,d=3,e=0;e<a.childNodes.length;e++)c=a.childNodes[e],c.nodeType===d?e+=b(c)?1:0:g(c,b)}var h;e=b.mixin({},d,e),e.node&&e.pattern&&(e.pattern=b.isArray(e.pattern)?e.pattern:[e.pattern],h=c(e.pattern,e.caseSensitive,e.wordsOnly),g(e.node,f))}}(window.document),o=function(){function c(c){var e,f,h,i,j=this;c=c||{},c.input||a.error("input is missing"),e=b.bind(this._onBlur,this),f=b.bind(this._onFocus,this),h=b.bind(this._onKeydown,this),i=b.bind(this._onInput,this),this.$hint=a(c.hint),this.$input=a(c.input).on("blur.tt",e).on("focus.tt",f).on("keydown.tt",h),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=b.noop),b.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){g[a.which||a.keyCode]||b.defer(b.bind(j._onInput,j,a))}):this.$input.on("input.tt",i),this.query=this.$input.val(),this.$overflowHelper=d(this.$input)}function d(b){return a('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:b.css("font-family"),fontSize:b.css("font-size"),fontStyle:b.css("font-style"),fontVariant:b.css("font-variant"),fontWeight:b.css("font-weight"),wordSpacing:b.css("word-spacing"),letterSpacing:b.css("letter-spacing"),textIndent:b.css("text-indent"),textRendering:b.css("text-rendering"),textTransform:b.css("text-transform")}).insertAfter(b)}function e(a,b){return c.normalizeQuery(a)===c.normalizeQuery(b)}function f(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var g;return g={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},c.normalizeQuery=function(a){return(a||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},b.mixin(c.prototype,m,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(a){var b=g[a.which||a.keyCode];this._managePreventDefault(b,a),b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(a,b){var c,d,e;switch(a){case"tab":d=this.getHint(),e=this.getInputValue(),c=d&&d!==e&&!f(b);break;case"up":case"down":c=!f(b);break;default:c=!1}c&&b.preventDefault()},_shouldTrigger:function(a,b){var c;switch(a){case"tab":c=!f(b);break;default:c=!0}return c},_checkInputValue:function(){var a,b,c;a=this.getInputValue(),b=e(a,this.query),c=b?this.query.length!==a.length:!1,b?c&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=a)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(a){this.query=a},getInputValue:function(){return this.$input.val()},setInputValue:function(a,b){this.$input.val(a),b?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,b,c,d;a=this.getInputValue(),b=this.getHint(),c=a!==b&&0===b.indexOf(a),d=""!==a&&c&&!this.hasOverflow(),!d&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var a=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,c,d;return a=this.$input.val().length,c=this.$input[0].selectionStart,b.isNumber(c)?c===a:document.selection?(d=document.selection.createRange(),d.moveStart("character",-a),a===d.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),c}(),p=function(){function c(c){c=c||{},c.templates=c.templates||{},c.source||a.error("missing source"),c.name&&!f(c.name)&&a.error("invalid dataset name: "+c.name),this.query=null,this.highlight=!!c.highlight,this.name=c.name||b.getUniqueId(),this.source=c.source,this.displayFn=d(c.display||c.displayKey),this.templates=e(c.templates,this.displayFn),this.$el=a(j.dataset.replace("%CLASS%",this.name))}function d(a){function c(b){return b[a]}return a=a||"value",b.isFunction(a)?a:c}function e(a,c){function d(a){return"<p>"+c(a)+"</p>"}return{empty:a.empty&&b.templatify(a.empty),header:a.header&&b.templatify(a.header),footer:a.footer&&b.templatify(a.footer),suggestion:a.suggestion||d}}function f(a){return/^[_a-zA-Z0-9-]+$/.test(a)}var g="ttDataset",h="ttValue",i="ttDatum";return c.extractDatasetName=function(b){return a(b).data(g)},c.extractValue=function(b){return a(b).data(h)},c.extractDatum=function(b){return a(b).data(i)},b.mixin(c.prototype,m,{_render:function(c,d){function e(){return p.templates.empty({query:c,isEmpty:!0})}function f(){function e(b){var c;return c=a(j.suggestion).append(p.templates.suggestion(b)).data(g,p.name).data(h,p.displayFn(b)).data(i,b),c.children().each(function(){a(this).css(k.suggestionChild)}),c}var f,l;return f=a(j.suggestions).css(k.suggestions),l=b.map(d,e),f.append.apply(f,l),p.highlight&&n({node:f[0],pattern:c}),f}function l(){return p.templates.header({query:c,isEmpty:!o})}function m(){return p.templates.footer({query:c,isEmpty:!o})}if(this.$el){var o,p=this;this.$el.empty(),o=d&&d.length,!o&&this.templates.empty?this.$el.html(e()).prepend(p.templates.header?l():null).append(p.templates.footer?m():null):o&&this.$el.html(f()).prepend(p.templates.header?l():null).append(p.templates.footer?m():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(a){function b(b){c.canceled||a!==c.query||c._render(a,b)}var c=this;this.query=a,this.canceled=!1,this.source(a,b)},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),c}(),q=function(){function c(c){var e,f,g,h=this;c=c||{},c.menu||a.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=b.map(c.datasets,d),e=b.bind(this._onSuggestionClick,this),f=b.bind(this._onSuggestionMouseEnter,this),g=b.bind(this._onSuggestionMouseLeave,this),this.$menu=a(c.menu).on("click.tt",".tt-suggestion",e).on("mouseenter.tt",".tt-suggestion",f).on("mouseleave.tt",".tt-suggestion",g),b.each(this.datasets,function(a){h.$menu.append(a.getRoot()),a.onSync("rendered",h._onRendered,h)})}function d(a){return new p(a)}return b.mixin(c.prototype,m,{_onSuggestionClick:function(b){this.trigger("suggestionClicked",a(b.currentTarget))},_onSuggestionMouseEnter:function(b){this._removeCursor(),this._setCursor(a(b.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function a(a){return a.isEmpty()}this.isEmpty=b.every(this.datasets,a),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(a,b){a.first().addClass("tt-cursor"),!b&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(a){var b,c,d,e;if(this.isOpen){if(c=this._getCursor(),b=this._getSuggestions(),this._removeCursor(),d=b.index(c)+a,d=(d+1)%(b.length+1)-1,-1===d)return void this.trigger("cursorRemoved");-1>d&&(d=b.length-1),this._setCursor(e=b.eq(d)),this._ensureVisible(e)}},_ensureVisible:function(a){var b,c,d,e;b=a.position().top,c=b+a.outerHeight(!0),d=this.$menu.scrollTop(),e=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>b?this.$menu.scrollTop(d+b):c>e&&this.$menu.scrollTop(d+(c-e))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(a){this.$menu.css("ltr"===a?k.ltr:k.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(a){var b=null;return a.length&&(b={raw:p.extractDatum(a),value:p.extractValue(a),datasetName:p.extractDatasetName(a)}),b},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(a){function c(b){b.update(a)}b.each(this.datasets,c)},empty:function(){function a(a){a.clear()}b.each(this.datasets,a),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function a(a){a.destroy()}this.$menu.off(".tt"),this.$menu=null,b.each(this.datasets,a)}}),c}(),r=function(){function c(c){var e,f,g;c=c||{},c.input||a.error("missing input"),this.isActivated=!1,this.autoselect=!!c.autoselect,this.minLength=b.isNumber(c.minLength)?c.minLength:1,this.$node=d(c.input,c.withHint),e=this.$node.find(".tt-dropdown-menu"),f=this.$node.find(".tt-input"),g=this.$node.find(".tt-hint"),f.on("blur.tt",function(a){var c,d,g;c=document.activeElement,d=e.is(c),g=e.has(c).length>0,b.isMsie()&&(d||g)&&(a.preventDefault(),a.stopImmediatePropagation(),b.defer(function(){f.focus()}))}),e.on("mousedown.tt",function(a){a.preventDefault()}),this.eventBus=c.eventBus||new l({el:f}),this.dropdown=new q({menu:e,datasets:c.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new o({input:f,hint:g}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}function d(b,c){var d,f,h,i;d=a(b),f=a(j.wrapper).css(k.wrapper),h=a(j.dropdown).css(k.dropdown),i=d.clone().css(k.hint).css(e(d)),i.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"}),d.data(g,{dir:d.attr("dir"),autocomplete:d.attr("autocomplete"),spellcheck:d.attr("spellcheck"),style:d.attr("style")}),d.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(c?k.input:k.inputWithNoHint);try{!d.attr("dir")&&d.attr("dir","auto")}catch(l){}return d.wrap(f).parent().prepend(c?i:null).append(h)}function e(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function f(a){var c=a.find(".tt-input");b.each(c.data(g),function(a,d){b.isUndefined(a)?c.removeAttr(d):c.attr(d,a)}),c.detach().removeData(g).removeClass("tt-input").insertAfter(a),a.remove()}var g="ttAttrs";return b.mixin(c.prototype,{_onSuggestionClicked:function(a,b){var c;(c=this.dropdown.getDatumForSuggestion(b))&&this._select(c)},_onCursorMoved:function(){var a=this.dropdown.getDatumForCursor();this.input.setInputValue(a.value,!0),this.eventBus.trigger("cursorchanged",a.raw,a.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(a,b){var c,d;c=this.dropdown.getDatumForCursor(),d=this.dropdown.getDatumForTopSuggestion(),c?(this._select(c),b.preventDefault()):this.autoselect&&d&&(this._select(d),b.preventDefault())},_onTabKeyed:function(a,b){var c;(c=this.dropdown.getDatumForCursor())?(this._select(c),b.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(a,b){this.input.clearHintIfInvalid(),b.length>=this.minLength?this.dropdown.update(b):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var a;this.dir!==(a=this.input.getLanguageDirection())&&(this.dir=a,this.$node.css("direction",a),this.dropdown.setLanguageDirection(a))},_updateHint:function(){var a,c,d,e,f,g;a=this.dropdown.getDatumForTopSuggestion(),a&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(c=this.input.getInputValue(),d=o.normalizeQuery(c),e=b.escapeRegExChars(d),f=new RegExp("^(?:"+e+")(.+$)","i"),g=f.exec(a.value),g?this.input.setHint(c+g[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(a){var b,c,d,e;b=this.input.getHint(),c=this.input.getQuery(),d=a||this.input.isCursorAtEnd(),b&&c!==b&&d&&(e=this.dropdown.getDatumForTopSuggestion(),e&&this.input.setInputValue(e.value),this.eventBus.trigger("autocompleted",e.raw,e.datasetName))},_select:function(a){this.input.setQuery(a.value),this.input.setInputValue(a.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",a.raw,a.datasetName),this.dropdown.close(),b.defer(b.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(a){this.isActivated?this.input.setInputValue(a):(this.input.setQuery(a),this.input.setInputValue(a,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),f(this.$node),this.$node=null}}),c}();!function(){var c,d,e;c=a.fn.typeahead,d="ttTypeahead",e={initialize:function(c,e){function f(){var f,g,h=a(this);b.each(e,function(a){a.highlight=!!c.highlight}),g=new r({input:h,eventBus:f=new l({el:h}),withHint:b.isUndefined(c.hint)?!0:!!c.hint,minLength:c.minLength,autoselect:c.autoselect,datasets:e}),h.data(d,g)}return e=b.isArray(e)?e:[].slice.call(arguments,1),c=c||{},this.each(f)},open:function(){function b(){var b,c=a(this);(b=c.data(d))&&b.open()}return this.each(b)},close:function(){function b(){var b,c=a(this);(b=c.data(d))&&b.close()}return this.each(b)},val:function(b){function c(){var c,e=a(this);(c=e.data(d))&&c.setVal(b)}function e(a){var b,c;return(b=a.data(d))&&(c=b.getVal()),c}return arguments.length?this.each(c):e(this.first())},destroy:function(){function b(){var b,c=a(this);(b=c.data(d))&&(b.destroy(),c.removeData(d))}return this.each(b)}},a.fn.typeahead=function(a){return e[a]?e[a].apply(this,[].slice.call(arguments,1)):e.initialize.apply(this,arguments)},a.fn.typeahead.noConflict=function(){return a.fn.typeahead=c,this}}()}(window.jQuery);;!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){"use strict";e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t},formData:function(e){return e.serializeArray()},add:function(t,i){return t.isDefaultPrevented()?!1:void((i.autoUpload||i.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()}))},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var r=e-this.timestamp;return(!this.bitrate||!i||r>i)&&(this.bitrate=(t-this.loaded)*(1e3/r)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,i):t._progress=i},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,i){if(t.lengthComputable){var r,n=Date.now?Date.now():(new Date).getTime();if(i._time&&i.progressInterval&&n-i._time<i.progressInterval&&t.loaded!==t.total)return;i._time=n,r=Math.floor(t.loaded/t.total*(i.chunkSize||i._progress.total))+(i.uploadedBytes||0),this._progress.loaded+=r-i._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(n,this._progress.loaded,i.bitrateInterval),i._progress.loaded=i.loaded=r,i._progress.bitrate=i.bitrate=i._bitrateTimer.getBitrate(n,r,i.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),i),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var i=this,r=t.xhr?t.xhr():e.ajaxSettings.xhr();r.upload&&(e(r.upload).bind("progress",function(e){var r=e.originalEvent;e.lengthComputable=r.lengthComputable,e.loaded=r.loaded,e.total=r.total,i._onProgress(e,t)}),t.xhr=function(){return r})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var i,r=this,n=t.files[0],s=t.multipart||!e.support.xhrFileUpload,o="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),s&&!t.blob&&this._isInstanceOf("File",n)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"'),s?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:o,value:t.blob}):e.each(t.files,function(r,n){i.push({name:"array"===e.type(t.paramName)&&t.paramName[r]||o,value:n})})):(r._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?i.append(o,t.blob,n.name):e.each(t.files,function(n,s){(r._isInstanceOf("File",s)||r._isInstanceOf("Blob",s))&&i.append("array"===e.type(t.paramName)&&t.paramName[n]||o,s,s.uploadName||s.name)})),t.data=i):(t.contentType=n.type||"application/octet-stream",t.data=t.blob||n),t.blob=null},_initIframeSettings:function(t){var i=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var i=e(t.fileInput),r=t.paramName;return r?e.isArray(r)||(r=[r]):(r=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",n=(t.prop("files")||[1]).length;n;)r.push(i),n-=1}),r.length||(r=[i.prop("name")||"files[]"])),r},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,r){var n=e.Deferred(),s=n.promise();return i=i||this.options.context||s,t===!0?n.resolveWith(i,r):t===!1&&n.rejectWith(i,r),s.abort=n.promise,this._enhancePromise(s)},_addConvenienceMethods:function(t,i){var r=this,n=function(t){return e.Deferred().resolveWith(r,t).promise()};i.process=function(t,s){return(t||s)&&(i._processQueue=this._processQueue=(this._processQueue||n([this])).pipe(function(){return i.errorThrown?e.Deferred().rejectWith(r,[i]).promise():n(arguments)}).pipe(t,s)),this._processQueue||n([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=r._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==!1&&r._onSend(t,this)),this.jqXHR||r._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",r._trigger("fail",null,this),r._getXHRPromise(!1))},i.state=function(){return this.jqXHR?r._getDeferredState(this.jqXHR):this._processQueue?r._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===r._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),r=i&&i.length>1&&parseInt(i[1],10);return r&&r+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var r,n,s=this,o=t.files[0],a=o.size,l=t.uploadedBytes,p=t.maxChunkSize||a,u=this._blobSlice,d=e.Deferred(),h=d.promise();return this._isXHRUpload(t)&&u&&(l||a>p)&&!t.data?i?!0:l>=a?(o.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",o.error])):(n=function(){var i=e.extend({},t),h=i._progress.loaded;i.blob=u.call(o,l,l+p,o.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+a,s._initXHRData(i),s._initProgressListener(i),r=(s._trigger("chunksend",null,i)!==!1&&e.ajax(i)||s._getXHRPromise(!1,i.context)).done(function(r,o,p){l=s._getUploadedBytes(p)||l+i.chunkSize,h+i.chunkSize-i._progress.loaded&&s._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=l,i.result=r,i.textStatus=o,i.jqXHR=p,s._trigger("chunkdone",null,i),s._trigger("chunkalways",null,i),a>l?n():d.resolveWith(i.context,[r,o,p])}).fail(function(e,t,r){i.jqXHR=e,i.textStatus=t,i.errorThrown=r,s._trigger("chunkfail",null,i),s._trigger("chunkalways",null,i),d.rejectWith(i.context,[e,t,r])})},this._enhancePromise(h),h.abort=function(){return r.abort()},n(),h):!1},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,r,n){var s=n._progress.total,o=n._response;n._progress.loaded<s&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:s,total:s}),n),o.result=n.result=t,o.textStatus=n.textStatus=i,o.jqXHR=n.jqXHR=r,this._trigger("done",null,n)},_onFail:function(e,t,i,r){var n=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),n.jqXHR=r.jqXHR=e,n.textStatus=r.textStatus=t,n.errorThrown=r.errorThrown=i,this._trigger("fail",null,r)},_onAlways:function(e,t,i,r){this._trigger("always",null,r)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var r,n,s,o,a=this,l=a._getAJAXSettings(i),p=function(){return a._sending+=1,l._bitrateTimer=new a._BitrateTimer,r=r||((n||a._trigger("send",e.Event("send",{delegatedEvent:t}),l)===!1)&&a._getXHRPromise(!1,l.context,n)||a._chunkedUpload(l)||e.ajax(l)).done(function(e,t,i){a._onDone(e,t,i,l)}).fail(function(e,t,i){a._onFail(e,t,i,l)}).always(function(e,t,i){if(a._onAlways(e,t,i,l),a._sending-=1,a._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>a._sending)for(var r=a._slots.shift();r;){if("pending"===a._getDeferredState(r)){r.resolve();break}r=a._slots.shift()}0===a._active&&a._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(s=e.Deferred(),this._slots.push(s),o=s.pipe(p)):(this._sequence=this._sequence.pipe(p,p),o=this._sequence),o.abort=function(){return n=[void 0,"abort","abort"],r?r.abort():(s&&s.rejectWith(l.context,n),p())},this._enhancePromise(o)):p()},_onAdd:function(t,i){var r,n,s,o,a=this,l=!0,p=e.extend({},this.options,i),u=i.files,d=u.length,h=p.limitMultiFileUploads,c=p.limitMultiFileUploadSize,f=p.limitMultiFileUploadSizeOverhead,g=0,_=this._getParamName(p),m=0;if(!c||d&&void 0!==u[0].size||(c=void 0),(p.singleFileUploads||h||c)&&this._isXHRUpload(p))if(p.singleFileUploads||c||!h)if(!p.singleFileUploads&&c)for(s=[],r=[],o=0;d>o;o+=1)g+=u[o].size+f,(o+1===d||g+u[o+1].size+f>c||h&&o+1-m>=h)&&(s.push(u.slice(m,o+1)),n=_.slice(m,o+1),n.length||(n=_),r.push(n),m=o+1,g=0);else r=_;else for(s=[],r=[],o=0;d>o;o+=h)s.push(u.slice(o,o+h)),n=_.slice(o,o+h),n.length||(n=_),r.push(n);else s=[u],r=[_];return i.originalFiles=u,e.each(s||u,function(n,o){var p=e.extend({},i);return p.files=s?o:[o],p.paramName=r[n],a._initResponseObject(p),a._initProgressObject(p),a._addConvenienceMethods(t,p),l=a._trigger("add",e.Event("add",{delegatedEvent:t}),p)}),l},_replaceFileInput:function(t){var i=t.clone(!0);e("<form></form>").append(i)[0].reset(),t.after(i).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,r){return r===t[0]?i[0]:r}),t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var r,n=this,s=e.Deferred(),o=function(e){e&&!e.entry&&(e.entry=t),s.resolve([e])};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,s.resolve(t._file)):t.file(function(e){e.relativePath=i,s.resolve(e)},o):t.isDirectory?(r=t.createReader(),r.readEntries(function(e){n._handleFileTreeEntries(e,i+t.name+"/").done(function(e){s.resolve(e)}).fail(o)},o)):s.resolve([]),s.promise()},_handleFileTreeEntries:function(t,i){var r=this;return e.when.apply(e,e.map(t,function(e){return r._handleFileTreeEntry(e,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var i,r,n=t.prop("webkitEntries")||t.prop("entries");if(n&&n.length)return this._handleFileTreeEntries(n);if(i=e.makeArray(t.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(r=t.prop("value"),!r)return e.Deferred().resolve([]).promise();i=[{name:r.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,r={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(r.fileInput).always(function(n){r.files=n,i.options.replaceFileInput&&i._replaceFileInput(r.fileInput),i._trigger("change",e.Event("change",{delegatedEvent:t}),r)!==!1&&i._onAdd(t,r)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,r={files:[]};i&&i.length&&(e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&r.files.push(i)}),this._trigger("paste",e.Event("paste",{delegatedEvent:t}),r)!==!1&&this._onAdd(t,r))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=this,r=t.dataTransfer,n={};r&&r.files&&r.files.length&&(t.preventDefault(),this._getDroppedFiles(r).always(function(r){n.files=r,i._trigger("drop",e.Event("drop",{delegatedEvent:t}),n)!==!1&&i._onAdd(t,n)}))},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=t.dataTransfer;i&&-1!==e.inArray("Files",i.types)&&this._trigger("dragover",e.Event("dragover",{delegatedEvent:t}))!==!1&&(t.preventDefault(),i.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,i){var r=-1!==e.inArray(t,this._specialOptions);r&&this._destroyEventHandlers(),this._super(t,i),r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return"url"!==t&&"string"===e.type(i)&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options,r=e(this.element[0].cloneNode(!1));e.each(r.data(),function(e,n){var s="data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();r.attr(s)&&(t._isRegExpOption(e,n)&&(n=t._getRegExp(n)),i[e]=n)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,r,n=this,s=e.Deferred(),o=s.promise();return o.abort=function(){return r=!0,i?i.abort():(s.reject(null,"abort","abort"),o)},this._getFileInputFiles(t.fileInput).always(function(e){if(!r){if(!e.length)return void s.reject();t.files=e,i=n._onSend(null,t).then(function(e,t,i){s.resolve(e,t,i)},function(e,t,i){s.reject(e,t,i)})}}),this._enhancePromise(o)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})});;(function($,c,b){$.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(d){a(d)});a("focusin","focus"+b);a("focusout","blur"+b);$.addOutsideEvent=a;function a(g,e){e=e||g+b;var d=$(),h=g+"."+e+"-special-event";$.event.special[e]={setup:function(){d=d.add(this);if(d.length===1){$(c).bind(h,f)}},teardown:function(){d=d.not(this);if(d.length===0){$(c).unbind(h)}},add:function(i){var j=i.handler;i.handler=function(l,k){l.target=k;j.apply(this,arguments)}}};function f(i){$(d).each(function(){var j=$(this);if(this!==i.target&&!j.has(i.target).length){j.triggerHandler(e,[i.target])}})}}})(jQuery,document,"outside");;!function(a){"use strict";"function"==typeof define&&define.amd?define(.jquery,a):a(jQuery)}(function(a){"use strict";function b(a){if(a instanceof Date)return a;if(String(a).match(g))return String(a).match(/^[0-9]*$/)&&(a=Number(a)),String(a).match(/\-/)&&(a=String(a).replace(/\-/g,"/")),new Date(a);throw new Error("Couldn't cast `"+a+"` to a date object.")}function c(a){return function(b){var c=b.match(/%(-|!)?[A-Z]{1}(:[^;]+;)?/gi);if(c)for(var e=0,f=c.length;f>e;++e){var g=c[e].match(/%(-|!)?([a-zA-Z]{1})(:[^;]+;)?/),i=new RegExp(g[0]),j=g[1]||"",k=g[3]||"",l=null;g=g[2],h.hasOwnProperty(g)&&(l=h[g],l=Number(a[l])),null!==l&&("!"===j&&(l=d(k,l)),""===j&&10>l&&(l="0"+l.toString()),b=b.replace(i,l.toString()))}return b=b.replace(/%%/,"%")}}function d(a,b){var c="s",d="";return a&&(a=a.replace(/(:|;|\s)/gi,"").split(/\,/),1===a.length?c=a[0]:(d=a[0],c=a[1])),1===Math.abs(b)?d:c}var e=100,f=[],g=[];g.push(/^[0-9]*$/.source),g.push(/([0-9]{1,2}\/){2}[0-9]{4}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),g.push(/[0-9]{4}([\/\-][0-9]{1,2}){2}( [0-9]{1,2}(:[0-9]{2}){2})?/.source),g=new RegExp(g.join("|"));var h={Y:"years",m:"months",w:"weeks",d:"days",D:"totalDays",H:"hours",M:"minutes",S:"seconds"},i=function(b,c,d){this.el=b,this.$el=a(b),this.interval=null,this.offset={},this.instanceNumber=f.length,f.push(this),this.$el.data("countdown-instance",this.instanceNumber),d&&(this.$el.on("update.countdown",d),this.$el.on("stoped.countdown",d),this.$el.on("finish.countdown",d)),this.setFinalDate(c),this.start()};a.extend(i.prototype,{start:function(){null!==this.interval&&clearInterval(this.interval);var a=this;this.update(),this.interval=setInterval(function(){a.update.call(a)},e)},stop:function(){clearInterval(this.interval),this.interval=null,this.dispatchEvent("stoped")},pause:function(){this.stop.call(this)},resume:function(){this.start.call(this)},remove:function(){this.stop(),f[this.instanceNumber]=null,delete this.$el.data().countdownInstance},setFinalDate:function(a){this.finalDate=b(a)},update:function(){return 0===this.$el.closest("html").length?void this.remove():(this.totalSecsLeft=this.finalDate.getTime()-(new Date).getTime(),this.totalSecsLeft=Math.ceil(this.totalSecsLeft/1e3),this.totalSecsLeft=this.totalSecsLeft<0?0:this.totalSecsLeft,this.offset={seconds:this.totalSecsLeft%60,minutes:Math.floor(this.totalSecsLeft/60)%60,hours:Math.floor(this.totalSecsLeft/60/60)%24,days:Math.floor(this.totalSecsLeft/60/60/24)%7,totalDays:Math.floor(this.totalSecsLeft/60/60/24),weeks:Math.floor(this.totalSecsLeft/60/60/24/7),months:Math.floor(this.totalSecsLeft/60/60/24/30),years:Math.floor(this.totalSecsLeft/60/60/24/365)},void(0===this.totalSecsLeft?(this.stop(),this.dispatchEvent("finish")):this.dispatchEvent("update")))},dispatchEvent:function(b){var d=a.Event(b+".countdown");d.finalDate=this.finalDate,d.offset=a.extend({},this.offset),d.strftime=c(this.offset),this.$el.trigger(d)}}),a.fn.countdown=function(){var b=Array.prototype.slice.call(arguments,0);return this.each(function(){var c=a(this).data("countdown-instance");if(void 0!==c){var d=f[c],e=b[0];i.prototype.hasOwnProperty(e)?d[e].apply(d,b.slice(1)):null===String(e).match(/^[$A-Z_][0-9A-Z_$]*$/i)?(d.setFinalDate.call(d,e),d.start()):a.error("Method %s does not exist on jQuery.countdown".replace(/\%s/gi,e))}else new i(this,b[0],b[1])})}});;if(typeof String.prototype.endsWith!=='function'){String.prototype.endsWith=function(suffix){return this.indexOf(suffix,this.length-suffix.length)!==-1}}
function check_email(str){var filter=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i
if(filter.test(str)){return true}
else{return false}};function check_url(url){var rgx=new RegExp("^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_\+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?");return rgx.test(url)}
function division(i,j){return i*Math.pow(j,-1)}
function human_file_size(bytes,si){var thresh=si?1000:1024;if(bytes<thresh){return bytes+' B'}
var units=si?['kB','MB','GB','TB','PB','EB','ZB','YB']:['KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB'];var u=-1;do{bytes=division(bytes,thresh);++u}while(bytes>=thresh);return bytes.toFixed(1)+' '+units[u]};function display_message(msg){var $msg_obj;for(var i=0;i<msg.length;i++){$msg_obj=$('<div class="alert alert-'+msg[i].type+'">'+msg[i].text+'<div class="alert-close"><i class="fa fa-times"></i></div></div>');$('#main .row:first').prepend($msg_obj);setTimeout(function($msg_obj_inner){$('.alert-close',$msg_obj_inner).trigger('click')},10000,$msg_obj)}}
function check_check_search(target){var val=$('#'+target).val();var datums=courses.index.datums;var datums_size=datums.length;var was_found=false;for(var i=0;i<datums_size;i++){var current_datum=datums[i];if(current_datum.course==val){was_found=true;window.location=site_data.search_base+current_datum.url;break}}
if(!was_found){$('#'+target).parent().parent().parent().submit()}}
var courses;var site_data;$(document).ready(function(){site_data=jQuery.parseJSON($('#site-data').html());moment.lang('en',{relativeTime:{future:"Om %s",past:"%s siden",s:"Noen få sekunder",m:"Ett minutt",mm:"%d minutter",h:"En time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"En måned",MM:"%d måneder",y:"Et år",yy:"%d år"}});courses=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace('course'),queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,prefetch:'processor/search/courses.json',});courses.initialize();if(site_data.cache_time!=localStorage.getItem('ts')){localStorage.clear();localStorage.setItem('ts',site_data.cache_time)}
$('#prefetch .typeahead,#prefetch2 .typeahead').typeahead({hint:true,highlight:true,},{name:'courses',displayKey:'course',source:courses.ttAdapter(),}).on('typeahead:selected',function($e,datum){check_check_search($e.target.id)});$('#s,#s2').on('keyup',function(e){if(e.keyCode==13){check_check_search(this.id)}});$('#nav-search,#nav-search2').on('click',function(){check_check_search($(this).parent().find('.tt-input').attr('id'))});$('.archive-item-dropdown').on('click',function(){var $caret=$('i',this);var $dropdown=$('.archive-dropdown-content',this);if($dropdown.is(':visible')){$dropdown.slideUp(400,function(){$caret.removeClass('fa-caret-up').addClass('fa-caret-down')})}
else{$dropdown.slideDown(400,function(){$caret.removeClass('fa-caret-down').addClass('fa-caret-up')})}});$('.archive-dropdown-close').on('click',function(e){e.preventDefault();$(this).parent().parent().parent().parent().find('.archive-item-dropdown-arrow').trigger('click')});var archive_id=0;var $archive_right_click=null;var $archive_context_menu=$('#archive-context-menu');var ignore_click_outside=false;if(site_data.user_online!=1){$('#archive-context-newflag-outer').hide();$('#archive-context-report').parent().hide()}
if($('#archive-can-c').val()!=1){$('#archive-context-newflag-outer').hide()}
$archive_context_menu.bind('clickoutside',function(e){if(ignore_click_outside){ignore_click_outside=false}
else{if($archive_context_menu.is(':visible')){$archive_context_menu.hide()}}});function load_flags(){$.ajax({cache:false,type:"post",url:"processor/flag/get",data:{id:archive_id},success:function(json){if(json.code==200){$('#flags-panel').html(json.html)}
else{$('#modal-flags').modal('hide');alert('Noe gikk galt under lastingen av flagg.')}}})}
$('#flags-panel').on('click','.flag-button',function(){$.ajax({cache:false,type:"post",url:"processor/flag/vote",data:{id:archive_id,flag:$(this).data('flag'),value:$(this).data('value')},success:function(json){if(json.code==200){load_flags()}
else{alert('Noe gikk galt under stemmingen. Prøv igjen!')}}})});$('#archive-context-flags').on('click',function(e){e.preventDefault();$('#modal-flags .modal-title').html('Flagg for: '+$archive_right_click.data('name'));$('#modal-flags').modal('show');load_flags()});$('#archive-context-report').on('click',function(e){e.preventDefault();$('#modal-report .modal-title').html('Rapporter: '+$archive_right_click.data('name'));$('#modal-report').modal('show')});$('#archive-heading-star').on('click',function(){var $that=$(this);var favorite_type='add';if($that.hasClass('archive-heading-star-1')){favorite_type='remove'}
$.ajax({cache:false,type:"post",url:'processor/favorite',data:{id:$that.data('archive-id'),type:favorite_type},success:function(json){if(json.code==200){if(favorite_type=='add'){$that.removeClass('archive-heading-star-0').addClass('archive-heading-star-1')}
else{$that.removeClass('archive-heading-star-1').addClass('archive-heading-star-0')}
display_message(json.msg)}
else{alert('Noe gikk visst galt her. Ups!')}}})});$('#archive-context-star-inside').on('click',function(e){e.preventDefault();if($archive_right_click!=null){var favorite_status=$archive_right_click.data('favorite');if(favorite_status==0||favorite_status==1){var favorite_type='add';if(favorite_status==1){favorite_type='remove'}
$.ajax({cache:false,type:"post",url:'processor/favorite',data:{id:$archive_right_click.data('id'),type:favorite_type},success:function(json){if(json.code==200){if(json.status){$archive_right_click.data('favorite',1)}
else{$archive_right_click.data('favorite',0)}
display_message(json.msg);$archive_context_menu.hide()}
else{alert('Noe gikk visst galt her. Ups!')}}})}}});$('.moment-timestamp').each(function(){var $that=$(this);$that.html(moment($(this).data('ts')).fromNow())});$('#home-most-popular-dropdown li').on('click',function(e){e.preventDefault();$('#home-most-popular-selected').html($('a',this).html());$('#home-most-popular-dropdown li').removeClass('disabled');$(this).addClass('disabled');$.ajax({cache:false,type:"post",url:"processor/module/update",data:{id:0,delta:$('a',$(this)).data('delta')},success:function(json){if(json.code==200){$('#home-most-popular').slideUp(400,function(){$(this).html(json.html).slideDown(400);$('#home-most-popular a').tooltip()})}
else{alert('Noe gikk visst galt her. Ups!')}}})});$('#login-dropdown label, #login-dropdown input').on('click',function(e){e.stopPropagation()});$('#archive-create-folder').on('click',function(){if($('#archive-create-folder-div').is(':visible')){$('#archive-create-folder-div').stop().slideUp()}
else{$('#archive-create-folder-div').stop().slideDown(400,function(){$('archive-create-folder-name').focus()});$('#archive-create-file-div').stop().slideUp();$('#archive-create-link-div').stop().slideUp()}});$('#archive-create-folder-div a').on('click',function(e){e.preventDefault();$('#archive-create-folder-div').stop().slideUp(400,function(){$('#archive-create-folder-name').val('')})});var submitting_archive_create_folder_form=false;$('#archive-create-folder-form').on('submit',function(){if($('#archive-create-folder-name').val().length==0){alert('Error: Du har ikke gitt mappen noen navn!')}
else{if(!submitting_archive_create_folder_form){submitting_archive_create_folder_form=true;$('#archive-create-folder-form-submit').html('Jobber...').prop('disabled',true);$.ajax({cache:false,type:"post",url:'processor/folder/create',data:{id:site_data.archive_id,name:$('#archive-create-folder-name').val()},success:function(json){submitting_archive_create_folder_form=false;if(json.code==200){window.location.reload()}
else if(json.code==400){display_message([{'text':'Et element med dette navnet finnes fra før!','type':'danger'}]);$('#archive-create-folder-form-submit').html('Lagre').prop('disabled',false)}
else if(json.code==401){display_message([{'text':'Navnet på elementet er fort kort. Minst 4 tegn.','type':'danger'}]);$('#archive-create-folder-form-submit').html('Lagre').prop('disabled',false)}
else{display_message([{'text':'Noe gikk visst galt her!','type':'danger'}]);$('#archive-create-folder-form-submit').html('Lagre').prop('disabled',false)}}})}}
return false});$('#modal-report-form > a').on('click',function(e){e.preventDefault();$('#modal-report').modal('hide')});$('#modal-report .dropdown li').on('click',function(e){e.preventDefault();$('#modal-report-selected').html($('a',this).html());$('#modal-report .dropdown li').removeClass('disabled');$(this).addClass('disabled')});$('#modal-report-form').on('submit',function(){$.ajax({cache:false,type:"post",url:"processor/report/send",data:{id:$archive_right_click.data('id'),text:$('#modal-report-form textarea').val(),category:$('#modal-report-selected').html()},success:function(json){if(json.code==200){$('#modal-report').modal('hide');setTimeout(function(){$('#model-report-text').val('');alert('Din rapportering er sendt. Takk.')},200)}
else{alert('Noe gikk visst galt!')}}});return false});var register_email_checked=false;var register_email_value="";$('#register-form input').on('keyup',function(){var $that=$(this);var $that_parent=$that.parent();var element_id=this.id;if(this.id=='register-form-email'){if(check_email($that.val())){if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')}
$('#register-form-email-error1').css('color','');if(register_email_value!=$('#register-form-email').val()){register_email_value=$('#register-form-email').val();register_email_checked=false;$.ajax({cache:false,type:"post",url:"processor/register/email",data:{email:$('#register-form-email').val()},success:function(json){if(json.code==200){register_email_checked=true;$('#register-form-email-error2').css('color','');$('#register-form-email').trigger('keyup')}
else{$('#register-form-email-error2').css('color','red')}}})}}
else{if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')}
$('#register-form-email-error1').css('color','red')}}
else if(this.id=='register-form-password1'){if($that.val().length<7){if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')}
$('#register-form-password-error1').css('color','red');$('#register-form-password2').prop('disabled',true).val('').parent().removeClass('has-error');$('#register-form-password-error2').css('color','')}
else{if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')}
$('#register-form-password-error1').css('color','');$('#register-form-password2').prop('disabled',false)}
if($('#register-form-password2').val().length!=0){if($('#register-form-password1').val()!=$('#register-form-password2').val()){if(!$('#register-form-password2').parent().hasClass('has-error')){$('#register-form-password2').parent().addClass('has-error')}
$('#register-form-password-error2').css('color','red')}
else{if($('#register-form-password2').parent().hasClass('has-error')){$('#register-form-password2').parent().removeClass('has-error')}
$('#register-form-password-error2').css('color','')}}}
else{if($('#register-form-password1').val()!=$('#register-form-password2').val()){if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')}
$('#register-form-password-error2').css('color','red')}
else{if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')}
$('#register-form-password-error2').css('color','')}}
if($('#register-form .has-error').length==0&&register_email_checked==true&&check_email($('#register-form-email').val())&&$('#register-form-password1').val().length>6&&$('#register-form-ret').is(':checked')){$('#register-form-submit').prop('disabled',false)}
else{$('#register-form-submit').prop('disabled',true)}});$('#register-form-ret').on('change',function(){$('#register-form-password1').trigger('keyup')})
$('#forgotten-password-new-form input').on('keyup',function(){var $that=$(this);var $that_parent=$that.parent();var element_id=this.id;if(this.id=='forgotten-password-new-form-password1'){if($that.val().length<7){if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')}
$('#forgotten-password-new-form-password-error1').css('color','red');$('#forgotten-password-new-form-password2').prop('disabled',true).val('').parent().removeClass('has-error');$('#forgotten-password-new-form-password-error2').css('color','')}
else{if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')}
$('#forgotten-password-new-form-password-error1').css('color','');$('#forgotten-password-new-form-password2').prop('disabled',false)}
if($('#forgotten-password-new-form-password2').val().length!=0){if($('#forgotten-password-new-form-password1').val()!=$('#forgotten-password-new-form-password2').val()){if(!$('#forgotten-password-new-form-password2').parent().hasClass('has-error')){$('#forgotten-password-new-form-password2').parent().addClass('has-error')}
$('#forgotten-password-new-form-password-error2').css('color','red')}
else{if($('#forgotten-password-new-form-password2').parent().hasClass('has-error')){$('#forgotten-password-new-form-password2').parent().removeClass('has-error')}
$('#forgotten-password-new-form-password-error2').css('color','')}}}
else{if($('#forgotten-password-new-form-password1').val()!=$('#forgotten-password-new-form-password2').val()){if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')}
$('#forgotten-password-new-form-password-error2').css('color','red')}
else{if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')}
$('#forgotten-password-new-form-password-error2').css('color','')}}
if($('#forgotten-password-new-form .has-error').length==0&&$('#forgotten-password-new-form-password1').val().length>6){$('#forgotten-password-new-form-submit').prop('disabled',false)}
else{$('#forgotten-password-new-form-submit').prop('disabled',true)}});$('#archive-create-file').on('click',function(){if($('#archive-create-file-div').is(':visible')){$('#archive-create-file-div').stop().slideUp()}
else{$('#archive-create-folder-div').stop().slideUp();$('#archive-create-link-div').stop().slideUp();$('#archive-create-file-div').stop().slideDown()}});$('#archive-create-file-div a').on('click',function(e){if($(this).attr('href')=='#'){e.preventDefault();$('#archive-create-file-div').stop().slideUp(400)}});var num_of_files=0;var num_of_files_uploaded=0;$('#archive-create-file-form').fileupload({url:'processor/file/create?format=html&parent='+site_data.archive_id,add:function(e,data){var file_object=data.files[data.files.length-1];var found=false;var name=file_object.name;var mimetype=file_object.type;var this_filetype=file_object.name.split('.');this_filetype=this_filetype[this_filetype.length-1].toLowerCase();for(var i=0;i<site_data.file_types.length;i++){if(name.endsWith('.'+site_data.file_types[i])){found=true;break}}
if(found){var inner_warning='';if(this_filetype=='zip'){inner_warning='<em>Innholdet i dette .zip-arkivet vil bli evaluert mot de godkjente filtypene, og kan ikke innehold andre .zip-arkiv'}
var $container=$('<div class="fileupload-file"><strong>'+name+'</strong><p>'+human_file_size(file_object.size,true)+'</p><div class="fileupload-file-remove"><span>Fjern <i class="fa fa-times"></i></span></div>'+inner_warning+'</div>');var $button=$('<button style="display: none;">x</button>');$container.append($button);data.context=$button;$button.click(function(){data.submit()});$('#fileupload-files-inner').append($container)}
else{var error=[{'text':'<p>Filtypen .'+this_filetype+' er ikke godkjent på Youkok2. Dersom du syntes denne filtypen burde godkjennes, kan du ta kontakt. Kontaktinformasjon nederst på siden.</p>','type':'danger',},];display_message(error)}
num_of_files=$('.fileupload-file').length-1},done:function(e,data){num_of_files_uploaded++;if(num_of_files_uploaded==num_of_files){window.location.reload()}},progressall:function(e,data){var progress=parseInt(division(data.loaded,data.total)*100,10);$('#progress .bar').css('width',progress+'%')},});$('#archive-create-file-form').on('submit',function(){$('#fileupload-files-inner button').each(function(){$(this).trigger('click')});$('#archive-create-file-form-submit').html('Laster opp....').prop('disabled',true);return false});$('#fileupload-files').on('click','.fileupload-file-remove',function(){$(this).parent().remove()});if($('#archive_accepted_filetypes').length>0){accepted_filetypes=jQuery.parseJSON($('#archive_accepted_filetypes').html());accepted_fileendings=jQuery.parseJSON($('#archive_accepted_fileendings').html())}
$('#archive-create-link').on('click',function(){if($('#archive-create-link-div').is(':visible')){$('#archive-create-link-div').stop().slideUp()}
else{$('#archive-create-link-div').stop().slideDown(400,function(){$('archive-create-link-url').focus()});$('#archive-create-file-div').stop().slideUp();$('#archive-create-folder-div').stop().slideUp()}});$('#archive-create-link-div a').on('click',function(e){e.preventDefault();$('#archive-create-link-div').stop().slideUp(400,function(){$('#archive-create-link-url').val('');$('#archive-create-link-name').val('')})});var autocomplete_title_xhr=null;$('#archive-create-link-url').on('keyup',function(e){var link_url=$(this).val();if(check_url(link_url)){$('#archive-create-link-form-submit').html('Vent litt').prop('disabled',true);if(autocomplete_title_xhr!==null){autocomplete_title_xhr.abort()}
autocomplete_title_xhr=$.ajax({cache:false,type:'post',url:'processor/link/title',data:{url:link_url,},success:function(json){if(json.code==200){$('#archive-create-link-name').val(json.title)}
if($('#archive-create-link-name-holder').is(':hidden')){$('#archive-create-link-name-holder').slideDown(400,function(){$('#archive-create-link-form-submit').html('Post').prop('disabled',false)})}
else{$('#archive-create-link-form-submit').html('Post').prop('disabled',false)}}})}
else{$('#archive-create-link-form-submit').html('Ikke gyldig link').prop('disabled',true)}});var submitting_archive_create_link_form=false;$('#archive-create-link-form').on('submit',function(){var link_name=$('#archive-create-link-url').val();if(link_name.length==0){display_message([{'text':'Du har ikke skrevet inn noen URL.','type':'danger'}])}
else{if(!check_url(link_name)){display_message([{'text':'\''+link_name+' \' er ikke en gyldig URL.','type':'danger'}])}
else{if(!submitting_archive_create_link_form){submitting_archive_create_link_form=true;$('#archive-create-link-form-submit').html('Jobber...').prop('disabled',true);$.ajax({cache:false,type:'post',url:'processor/link/create',data:{id:site_data.archive_id,url:$('#archive-create-link-url').val(),name:$('#archive-create-link-name').val()},success:function(json){submitting_archive_create_link_form=false;if(json.code==200){window.location.reload()}
else if(json.code==400){display_message([{'text':'Et element med denne URLen finnes fra før!','type':'danger'}]);$('#archive-create-link-form-submit').html('Lagre').prop('disabled',false)}
else if(json.code==401){display_message([{'text':'Navnet på linken er for kort. Minst 4 tegn. La feltet så tomt hvis du ønsker å bruke URLen.','type':'danger'}]);$('#archive-create-link-form-submit').html('Lagre').prop('disabled',false)}
else{display_message([{'text':'Noe gikk visst galt her!','type':'danger'}]);$('#archive-create-link-form-submit').html('Lagre').prop('disabled',false)}}})}}}
return false});if($('#archive-history').length>0){$.ajax({cache:false,type:"post",url:"processor/history/get",data:{id:site_data.archive_id,},success:function(json){$('#archive-history ul').html(json.html)}})}
$('#main').on('click','.alert-close',function(){$(this).parent().slideUp(400,function(){$(this).remove()})});if($('.alert').length>0){$('.alert').each(function(){if(!$(this).hasClass('no-close-auto')){setTimeout(function(target){console.log(target);$(target).find('.alert-close').trigger('click')},10000,$(this))}})};$('#archive-context-new-flag-name').on('click',function(e){e.preventDefault();$('#modal-new-flag .modal-title').html('Endre navn på: '+$archive_right_click.data('name'));if($archive_right_click.data('type')=='dir'){$('#modal-new-flag-name .input-group .input-group-addon').html(' ')}
else{var filetype_index=$archive_right_click.data('name').lastIndexOf('.');$('#modal-new-flag-name .input-group .input-group-addon').html($archive_right_click.data('name').substr(filetype_index))}
$('#modal-new-flag').modal('show');$('.modal-new-flag-container').hide();$('#modal-new-flag-name').show()});$('#modal-new-flag-name-form').on('submit',function(){if($('#modal-new-flag-name-name').val().length==0){alert('Du glemte å skrive inn et navn...')}
else{$.ajax({cache:false,type:"post",url:"processor/flag/name",data:{id:$archive_right_click.data('id'),name:$('#modal-new-flag-name-name').val(),filetype:$('#modal-new-flag-name .input-group .input-group-addon').html(),comment:$('#modal-new-flag-name-comment').val()},success:function(json){if(json.code==200){window.location.reload()}
else{alert('Noe gikk visst galt her!')}}})}
return false});$('#archive-context-new-flag-delete').on('click',function(e){e.preventDefault();$('#modal-new-flag .modal-title').html('Sletting av: '+$archive_right_click.data('name'));$('#modal-new-flag').modal('show');$('.modal-new-flag-container').hide();$('#modal-new-flag-delete').show()});$('#modal-new-flag-delete-form').on('submit',function(){$.ajax({cache:false,type:"post",url:"processor/flag/delete",data:{id:$archive_right_click.data('id'),comment:$('#modal-new-flag-delete-comment').val()},success:function(json){if(json.code==200){window.location.reload()}
else{alert('Noe gikk visst galt her!')}}});return false});$('#dropdown-menu-opener').on('click',function(e){setTimeout(function(){$('#login-email').focus()},100)});$('.login-opener').on('click',function(e){e.preventDefault();e.stopPropagation();$('#login-dropdown').dropdown('toggle');setTimeout(function(){$('#login-email').focus()},100)});var profile_email_value="";$('#profile-edit-info-form input').on('keyup',function(){var $that=$(this);var $that_parent=$that.parent();var element_id=this.id;if(this.id=='register-form-email'){if(check_email($that.val())){if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')}
$('#register-form-email-error1').css('color','');if(profile_email_value!=$('#register-form-email').val()){profile_email_value=$('#register-form-email').val();$.ajax({cache:false,type:"post",url:"processor/register/email",data:{email:$('#register-form-email').val(),ignore:true},success:function(json){if(json.code==200){$('#register-form-email-error2').css('color','')}
else{$('#register-form-email-error2').css('color','red')}}})}}
else{if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')}
$('#register-form-email-error1').css('color','red')}}});if($('#archive-sidebar-newest-inner').length>0){$.ajax({cache:false,url:'graybox/newest',success:function(html){$('#archive-sidebar-newest-inner').html(html);$('#archive-sidebar-newest-inner .moment-timestamp').each(function(){$that=$(this);$that.html(moment($(this).data('ts')).fromNow())})}})}
if($('#archive-sidebar-last-downloads-inner').length>0){$.ajax({cache:false,url:'graybox/downloads',success:function(html){$('#archive-sidebar-last-downloads-inner').html(html);$('#archive-sidebar-last-downloads-inner .moment-timestamp').each(function(){$that=$(this);$that.html(moment($(this).data('ts')).fromNow())})}})}
if($('#archive-sidebar-numbers-inner').length>0){$.ajax({cache:false,url:'graybox/numbers',success:function(html){$('#archive-sidebar-numbers-inner').html(html)}})}
$('.list-group-item a, .list-group-item .moment-timestamp').tooltip();var removing_fav=false;$('.star-remove').on('click',function(){$el=$(this);if(!removing_fav){removing_fav=true;$.ajax({cache:false,type:"post",url:'processor/favorite',data:{id:$el.data('id'),type:'remove'},success:function(json){if(json.code==200){$el.parent().slideUp(function(){$(this).remove();if($('#favorites-list li').length==0){$('#favorites-list').html('<li class="list-group-item" style="display: none;"><em>Du har ingen favoritter...</em></li>');$('#favorites-list li').slideDown()}
removing_fav=false});display_message(json.msg)}
else{alert('Noe gikk visst galt her. Ups!');removing_fav=false}}})}});var popularity_chart=null;var popularity_chart_options=null;$('#archive-context-info').on('click',function(e){e.preventDefault();$('#modal-info .modal-title').html('Detaljer for: '+$archive_right_click.data('name'));$('#modal-info').modal('show');$.ajax({cache:false,type:"post",url:"processor/element/info",data:{id:archive_id},success:function(json){if(json.code==200){$('#info-panel').html(json.html);$('#info-panel .moment-timestamp').html(moment($('#info-panel .moment-timestamp').data('ts')).fromNow());popularity_chart_options.series[0].data=[];if(popularity_chart!==null){popularity_chart.destroy()}
var data_dirty=jQuery.parseJSON($('#modal-info-graph-data').html());var data_clean=[];for(var i=0;i<data_dirty.length;i++){data_clean.push([eval(data_dirty[i][0]),parseInt(data_dirty[i][1],10)])}
popularity_chart_options.series[0].data=data_clean;popularity_chart=new Highcharts.Chart(popularity_chart_options)}
else{$('#modal-info').modal('hide');alert('Noe gikk galt under lastingen av detaljer.')}}})});popularity_chart_options={lang:{loading:'Laster...',months:['Januar','Februar','Mars','April','Mai','Juni','Juli','August','September','Oktober','November','Desember'],weekdays:['Søndag','Mandag','Tirsdag','Onsdag','Torsdag','Fredag','Lørdag'],shortMonths:['Jan','Feb','Mar','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Des'],},chart:{renderTo:'modal-info-graph',height:150,width:558,},title:{text:'',style:{display:'none'}},xAxis:{type:'datetime',dateTimeLabelFormats:{month:'%e. %b',year:'%b'},},yAxis:{min:0,title:{enabled:false,},},tooltip:{headerFormat:'<b>Antall totale nedlastninger</b><br>',pointFormat:'{point.x:%e. %b %Y}: {point.y:.0f}'},legend:{enabled:false},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},series:[{name:'Populæritet',data:[],}]};if($('.countdown-wrapper').length>0){var template='<div class="time">';template+='    <span class="count curr top"></span>';template+='    <span class="count next top">></span>';template+='    <span class="count next bottom"></span>';template+='    <span class="count curr bottom"></span>';template+='    <span class="label"></span>';template+='</div>';var labels=['dager','timer','minutter','sekunder'],currDate='00:00:00:00',nextDate='00:00:00:00',$countdown_container=$('.countdown-wrapper');function strfobj(str){var parsed=str.split(':'),obj={};labels.forEach(function(label,i){obj[label]=parsed[i]});return obj}
function diff(obj1,obj2){var diff=[];labels.forEach(function(key){if(obj1[key]!==obj2[key]){diff.push(key)}});return diff}
var initData=strfobj(currDate);labels.forEach(function(label,i){var $section=$($.parseHTML(template));$section.addClass(label);$section.find('.label').html(label);$countdown_container.append($section)});$countdown_container.countdown($countdown_container.data('exam'),function(event){var newDate=event.strftime('%D:%H:%M:%S'),data;if(newDate!==nextDate){currDate=nextDate;nextDate=newDate;data={'curr':strfobj(currDate),'next':strfobj(nextDate)};diff(data.curr,data.next).forEach(function(label){var selector='.%s'.replace(/%s/,label),$node=$countdown_container.find(selector);$node.removeClass('flip');$node.find('.curr').text(data.curr[label]);$node.find('.next').text(data.next[label]);setTimeout(function($node){$node.addClass('flip')},50,$node)})}})}
$('#toggle-queries').on('click',function(e){e.preventDefault();var $that=$(this);if($('#cache-load').is(':visible')){$('#cache-load').slideUp(400,function(){$('#toggle-cache-loads span').html('Vis')})}
if($('#queries').is(':visible')){$('#queries').slideUp(400,function(){$('span',$that).html('Vis')})}
else{$('#queries').slideDown(400,function(){$('span',$that).html('Skjul')})}});$('#toggle-cache-loads').on('click',function(e){e.preventDefault();var $that=$(this);if($('#queries').is(':visible')){$('#queries').slideUp(400,function(){$('#toggle-queries span').html('Vis')})}
if($('#cache-load').is(':visible')){$('#cache-load').slideUp(400,function(){$('span',$that).html('Vis')})}
else{$('#cache-load').slideDown(400,function(){$('span',$that).html('Skjul')})}})});;function thousand_sep(x){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}
$(document).ready(function(){function init(){var data_dirty1=jQuery.parseJSON($('#admin-graph .admin-graph-hidden').html());var data_clean1=[];for(var i=0;i<data_dirty1.length;i++){data_clean1.push([eval(data_dirty1[i][0]),parseInt(data_dirty1[i][1],10)])}
admin_chart1_options.series[0].data=data_clean1;admin_chart1=new Highcharts.Chart(admin_chart1_options);var data_dirty2=jQuery.parseJSON($('#admin-graph-acc .admin-graph-hidden').html());var data_clean2=[];for(var i=0;i<data_dirty2.length;i++){data_clean2.push([eval(data_dirty2[i][0]),parseInt(data_dirty2[i][1],10)])}
admin_chart2_options.series[0].data=data_clean2;admin_chart2=new Highcharts.Chart(admin_chart2_options)}
$('#admin-scripts a').on('click',function(e){e.preventDefault();$('#modal-admin-script .modal-body').html('');$('#modal-admin-script .modal-body').html('<iframe id="modal-admin-iframe" src="'+site_data.search_base+'../'+$(this).data('endpoint')+'"></iframe>');$('#modal-admin-script .modal-title').html($(this).text());$('#modal-admin-script').modal('show')});var admin_chart1=null;var admin_chart1_options={lang:{loading:'Laster...',months:['Januar','Februar','Mars','April','Mai','Juni','Juli','August','September','Oktober','November','Desember'],weekdays:['Søndag','Mandag','Tirsdag','Onsdag','Torsdag','Fredag','Lørdag'],shortMonths:['Jan','Feb','Mar','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Des'],},chart:{renderTo:'admin-graph1-display',height:200,},title:{text:'',style:{display:'none'}},xAxis:{type:'datetime',dateTimeLabelFormats:{month:'%e. %b',year:'%b'},},yAxis:{min:0,title:{enabled:false,},},tooltip:{headerFormat:'<b>Antall nedlastninger</b><br>',pointFormat:'{point.x:%e. %b %Y}: {point.y:.0f}'},legend:{enabled:false},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},series:[{name:'Populæritet',data:[],}]};var admin_chart2=null;var admin_chart2_options={lang:{loading:'Laster...',months:['Januar','Februar','Mars','April','Mai','Juni','Juli','August','September','Oktober','November','Desember'],weekdays:['Søndag','Mandag','Tirsdag','Onsdag','Torsdag','Fredag','Lørdag'],shortMonths:['Jan','Feb','Mar','Apr','Mai','Jun','Jul','Aug','Sep','Okt','Nov','Des'],},chart:{renderTo:'admin-graph2-display',height:200,},title:{text:'',style:{display:'none'}},xAxis:{type:'datetime',dateTimeLabelFormats:{month:'%e. %b',year:'%b'},},yAxis:{min:0,title:{enabled:false,},},tooltip:{headerFormat:'<b>Antall totale nedlastninger</b><br>',pointFormat:'{point.x:%e. %b %Y}: {point.y:.0f}'},legend:{enabled:false},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},series:[{name:'Populæritet',data:[],}]};init()})