if(typeof String.prototype.endsWith!=='function'){String.prototype.endsWith=function(suffix){return this.indexOf(suffix,this.length-suffix.length)!==-1}};function check_email(str){var filter=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;if(filter.test(str)){return true}else{return false}};function check_url(url){var rgx=new RegExp("^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}([0-9A-Za-z-\\.@:%_\+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?");return rgx.test(url)};function division(i,j){return i*Math.pow(j,-1)};function human_file_size(bytes,si){var thresh=si?1000:1024;if(bytes<thresh){return bytes+' B'};var units=si?['kB','MB','GB','TB','PB','EB','ZB','YB']:['KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB'];var u=-1;do{bytes=division(bytes,thresh);++u}while(bytes>=thresh);return bytes.toFixed(1)+' '+units[u]};function display_message(msg){var $msg_obj;for(var i=0;i<msg.length;i++){$msg_obj=$('<div class="alert alert-'+msg[i].type+'">'+msg[i].text+'<div class="alert-close"><i class="fa fa-times"></i></div></div>');$('#main_messages').append($msg_obj);setTimeout(function($msg_obj_inner){$('.alert-close',$msg_obj_inner).trigger('click')},10000,$msg_obj)}};moment.lang('en',{relativeTime:{future:"Om %s",past:"%s siden",s:"Noen få sekunder",m:"Ett minutt",mm:"%d minutter",h:"En time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"En måned",MM:"%d måneder",y:"Et år",yy:"%d år"}});var courses=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace('course'),queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,prefetch:'processor/search/courses.json',});courses.initialize();function check_check_search(target){var val=$('#'+target).val();var datums=courses.index.datums;var datums_size=datums.length;var was_found=false;for(var i=0;i<datums_size;i++){var current_datum=datums[i];if(current_datum.course==val){was_found=true;window.location=$('#search-base').val()+current_datum.url;break}};if(!was_found){$('#'+target).parent().parent().parent().submit()}};$(document).ready(function(){if($('#typehead-cache-time').val()!=localStorage.getItem('ts')){localStorage.clear();localStorage.setItem('ts',$('#typehead-cache-time').val())};$('#prefetch .typeahead,#prefetch2 .typeahead').typeahead({hint:true,highlight:true,},{name:'courses',displayKey:'course',source:courses.ttAdapter(),}).on('typeahead:selected',function($e,datum){check_check_search($e.target.id)});$('#s,#s2').on('keyup',function(e){if(e.keyCode==13){check_check_search(this.id)}});$('#nav-search,#nav-search2').on('click',function(){check_check_search($(this).parent().find('.tt-input').attr('id'))});var archive_id=0;var $archive_right_click=null;var $archive_context_menu=$('#archive-context-menu');var ignore_click_outside=false;if($('#archive-online').val()!=1){$('#archive-context-newflag-outer').hide();$('#archive-context-report').parent().hide()};if($('#archive-can-c').val()!=1){$('#archive-context-newflag-outer').hide()};$archive_context_menu.bind('clickoutside',function(e){if(ignore_click_outside){ignore_click_outside=false}else{if($archive_context_menu.is(':visible')){$archive_context_menu.hide()}}});$('body').on('contextmenu','.archive-item',function(e){ignore_click_outside=true;var $that=$(this);$archive_right_click=$that;archive_id=$that.data('id');$('#archive-context-menu-id',$archive_context_menu).html($that.data('name'));$('#archive-context-menu-size',$archive_context_menu).html(' ('+human_file_size($that.data('size'),true)+')');$('#archive-context-menu-flags',$archive_context_menu).html($that.data('flags'));var link=$that.parent().attr('href');if($that.data('type')=='dir'){$('#archive-context-open',$archive_context_menu).show();$('#archive-context-open a',$archive_context_menu).show().attr('href',link);$('#archive-context-download,#archive-context-new-flag-delete,#archive-context-new-flag-move',$archive_context_menu).hide()}else{$('#archive-context-download',$archive_context_menu).show();$('#archive-context-download a',$archive_context_menu).show().attr('href',link);$('#archive-context-download,#archive-context-new-flag-delete,#archive-context-new-flag-move',$archive_context_menu).show();$('#archive-context-open',$archive_context_menu).hide()};if($that.data('favorite')==null){$('#archive-context-star',$archive_context_menu).hide()}else{$('#archive-context-star',$archive_context_menu).show();if($that.data('favorite')==1){$('#archive-context-star-inside',$archive_context_menu).html('Fjern favoritt')}else{$('#archive-context-star-inside',$archive_context_menu).html('Legg til favoritt')}};$archive_context_menu.css({display:'block',left:e.pageX-$('#archive-list').offset().left+45,top:e.pageY-$('#archive-top').offset().top+10,});return false});$('#archive-context-close').on('click',function(e){e.preventDefault();$archive_context_menu.hide()});$('#archive-context-flags,#archive-context-info,#archive-context-report').on('click',function(){$archive_context_menu.hide()});$('#archive-context-newflag').on('click',function(e){e.preventDefault()});function load_flags(){$.ajax({cache:false,type:"post",url:"processor/flag/get",data:{id:archive_id},success:function(json){if(json.code==200){$('#flags-panel').html(json.html)}else{$('#modal-flags').modal('hide');alert('Noe gikk galt under lastingen av flagg.')}}})};$('#flags-panel').on('click','.flag-button',function(){$.ajax({cache:false,type:"post",url:"processor/flag/vote",data:{id:archive_id,flag:$(this).data('flag'),value:$(this).data('value')},success:function(json){if(json.code==200){load_flags()}else{alert('Noe gikk galt under stemmingen. Prøv igjen!')}}})});$('#archive-context-flags').on('click',function(e){e.preventDefault();$('#modal-flags .modal-title').html('Flagg for: '+$archive_right_click.data('name'));$('#modal-flags').modal('show');load_flags()});$('#archive-context-report').on('click',function(e){e.preventDefault();$('#modal-report .modal-title').html('Rapporter: '+$archive_right_click.data('name'));$('#modal-report').modal('show')});$('#archive-heading-star').on('click',function(){var $that=$(this);var favorite_type='add';if($that.hasClass('archive-heading-star-1')){favorite_type='remove'};$.ajax({cache:false,type:"post",url:"processor/favorite/"+favorite_type,data:{id:$that.data('archive-id')},success:function(json){if(json.code==200){if(json.status){$that.removeClass('archive-heading-star-0').addClass('archive-heading-star-1')}else{$that.removeClass('archive-heading-star-1').addClass('archive-heading-star-0')};display_message(json.msg)}else{alert('Noe gikk visst galt her. Ups!')}}})});$('#archive-context-star-inside').on('click',function(e){e.preventDefault();if($archive_right_click!=null){var favorite_status=$archive_right_click.data('favorite');if(favorite_status==0||favorite_status==1){var favorite_type='add';if(favorite_status==1){favorite_type='remove'};$.ajax({cache:false,type:"post",url:"processor/favorite/"+favorite_type,data:{id:$archive_right_click.data('id')},success:function(json){if(json.code==200){if(json.status){$archive_right_click.data('favorite',1)}else{$archive_right_click.data('favorite',0)};display_message(json.msg);$archive_context_menu.hide()}else{alert('Noe gikk visst galt her. Ups!')}}})}}});$('.moment-timestamp').each(function(){$that=$(this);$that.html(moment($(this).data('ts')).fromNow())});$('#home-most-popular-dropdown li').on('click',function(e){e.preventDefault();$('#home-most-popular-selected').html($('a',this).html());$('#home-most-popular-dropdown li').removeClass('disabled');$(this).addClass('disabled');$.ajax({cache:false,type:"post",url:"processor/popular/update",data:{delta:$('a',$(this)).data('delta')},success:function(json){if(json.code==200){$('#home-most-popular').slideUp(400,function(){$(this).html(json.html).slideDown(400);$('#home-most-popular a').tooltip()})}else{alert('Noe gikk visst galt her. Ups!')}}})});$('#login-dropdown label, #login-dropdown input').on('click',function(e){e.stopPropagation()});$('#archive-create-folder').on('click',function(){if($('#archive-create-folder-div').is(':visible')){$('#archive-create-folder-div').stop().slideUp()}else{$('#archive-create-folder-div').stop().slideDown(400,function(){$('archive-create-folder-name').focus()});$('#archive-create-file-div').stop().slideUp();$('#archive-create-link-div').stop().slideUp()}});$('#archive-create-folder-div a').on('click',function(e){e.preventDefault();$('#archive-create-folder-div').stop().slideUp(400,function(){$('#archive-create-folder-name').val('')})});var submitting_archive_create_folder_form=false;$('#archive-create-folder-form').on('submit',function(){if($('#archive-create-folder-name').val().length==0){alert('Error: Du har ikke gitt mappen noen navn!')}else{if(!submitting_archive_create_folder_form){submitting_archive_create_folder_form=true;$('#archive-create-folder-form-submit').html('Jobber...').prop('disabled',true);$.ajax({cache:false,type:"post",url:"processor/create/folder",data:{id:$('#archive-id').val(),name:$('#archive-create-folder-name').val()},success:function(json){submitting_archive_create_folder_form=false;if(json.code==200){window.location.reload()}else if(json.code==400){display_message([{'text':'Et element med dette navnet finnes fra før!','type':'danger'}])}else{display_message([{'text':'Noe gikk visst galt her!','type':'danger'}])}}})}};return false});$('#modal-report-form > a').on('click',function(e){e.preventDefault();$('#modal-report').modal('hide')});$('#modal-report .dropdown li').on('click',function(e){e.preventDefault();$('#modal-report-selected').html($('a',this).html());$('#modal-report .dropdown li').removeClass('disabled');$(this).addClass('disabled')});$('#modal-report-form').on('submit',function(){$.ajax({cache:false,type:"post",url:"processor/report/send",data:{id:$archive_right_click.data('id'),text:$('#modal-report-form textarea').val(),category:$('#modal-report-selected').html()},success:function(json){if(json.code==200){$('#modal-report').modal('hide');setTimeout(function(){$('#model-report-text').val('');alert('Din rapportering er sendt. Takk.')},200)}else{alert('Noe gikk visst galt!')}}});return false});var register_email_checked=false;var register_email_value="";$('#register-form input').on('keyup',function(){var $that=$(this);var $that_parent=$that.parent();var element_id=this.id;if(this.id=='register-form-email'){if(check_email($that.val())){if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')};$('#register-form-email-error1').css('color','');if(register_email_value!=$('#register-form-email').val()){register_email_value=$('#register-form-email').val();register_email_checked=false;$.ajax({cache:false,type:"post",url:"processor/register/check",data:{email:$('#register-form-email').val()},success:function(json){if(json.code==200){register_email_checked=true;$('#register-form-email-error2').css('color','');$('#register-form-email').trigger('keyup')}else{$('#register-form-email-error2').css('color','red')}}})}}else{if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')};$('#register-form-email-error1').css('color','red')}}else if(this.id=='register-form-password1'){if($that.val().length<7){if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')};$('#register-form-password-error1').css('color','red');$('#register-form-password2').prop('disabled',true).val('').parent().removeClass('has-error');$('#register-form-password-error2').css('color','')}else{if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')};$('#register-form-password-error1').css('color','');$('#register-form-password2').prop('disabled',false)};if($('#register-form-password2').val().length!=0){if($('#register-form-password1').val()!=$('#register-form-password2').val()){if(!$('#register-form-password2').parent().hasClass('has-error')){$('#register-form-password2').parent().addClass('has-error')};$('#register-form-password-error2').css('color','red')}else{if($('#register-form-password2').parent().hasClass('has-error')){$('#register-form-password2').parent().removeClass('has-error')};$('#register-form-password-error2').css('color','')}}}else{if($('#register-form-password1').val()!=$('#register-form-password2').val()){if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')};$('#register-form-password-error2').css('color','red')}else{if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')};$('#register-form-password-error2').css('color','')}};if($('#register-form .has-error').length==0&&register_email_checked==true&&check_email($('#register-form-email').val())&&$('#register-form-password1').val().length>6&&$('#register-form-ret').is(':checked')){$('#register-form-submit').prop('disabled',false)}else{$('#register-form-submit').prop('disabled',true)}});$('#register-form-ret').on('change',function(){$('#register-form-password1').trigger('keyup')});$('#forgotten-password-new-form input').on('keyup',function(){var $that=$(this);var $that_parent=$that.parent();var element_id=this.id;if(this.id=='forgotten-password-new-form-password1'){if($that.val().length<7){if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')};$('#forgotten-password-new-form-password-error1').css('color','red');$('#forgotten-password-new-form-password2').prop('disabled',true).val('').parent().removeClass('has-error');$('#forgotten-password-new-form-password-error2').css('color','')}else{if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')};$('#forgotten-password-new-form-password-error1').css('color','');$('#forgotten-password-new-form-password2').prop('disabled',false)};if($('#forgotten-password-new-form-password2').val().length!=0){if($('#forgotten-password-new-form-password1').val()!=$('#forgotten-password-new-form-password2').val()){if(!$('#forgotten-password-new-form-password2').parent().hasClass('has-error')){$('#forgotten-password-new-form-password2').parent().addClass('has-error')};$('#forgotten-password-new-form-password-error2').css('color','red')}else{if($('#forgotten-password-new-form-password2').parent().hasClass('has-error')){$('#forgotten-password-new-form-password2').parent().removeClass('has-error')};$('#forgotten-password-new-form-password-error2').css('color','')}}}else{if($('#forgotten-password-new-form-password1').val()!=$('#forgotten-password-new-form-password2').val()){if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')};$('#forgotten-password-new-form-password-error2').css('color','red')}else{if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')};$('#forgotten-password-new-form-password-error2').css('color','')}};if($('#forgotten-password-new-form .has-error').length==0&&$('#forgotten-password-new-form-password1').val().length>6){$('#forgotten-password-new-form-submit').prop('disabled',false)}else{$('#forgotten-password-new-form-submit').prop('disabled',true)}});if($('#archive-list').length>0&&$('#archive-list li').length==0){$('#archive-list').hide();$('#archive-empty').show()};if($('#archive-list').length>0){var display=false;$('#archive-list li').each(function(){if(display==false&&$(this).find('div').data('type')=='file'){display=true}});if(display){$('#archive-zip').show()}};$('#archive-create-file').on('click',function(){if($('#archive-create-file-div').is(':visible')){$('#archive-create-file-div').stop().slideUp()}else{$('#archive-create-folder-div').stop().slideUp();$('#archive-create-link-div').stop().slideUp();$('#archive-create-file-div').stop().slideDown()}});$('#archive-create-file-div a').on('click',function(e){if($(this).attr('href')=='#'){e.preventDefault();$('#archive-create-file-div').stop().slideUp(400)}});var num_of_files=0;var num_of_files_uploaded=0;var accepted_filetypes=[];var accepted_fileendings=[];$('#archive-create-file-form').fileupload({url:'processor/create/file',add:function(e,data){var file_object=data.files[data.files.length-1];var found=false;var name=file_object.name;var mimetype=file_object.type;var this_filetype=file_object.name.split('.');this_filetype=this_filetype[this_filetype.length-1].toLowerCase();if(mimetype!=null){for(var i=0;i<accepted_filetypes.length;i++){if(accepted_filetypes[i]==mimetype){found=true;break}}};if(!found){for(var i=0;i<accepted_fileendings.length;i++){if(name.endsWith('.'+accepted_fileendings[i])){found=true;break}}};if(found){var inner_warning='';if(this_filetype=='zip'){inner_warning='<em>Innholdet i dette .zip-arkivet vil bli evaluert mot de godkjente filtypene, og kan ikke innehold andre .zip-arkiv'};var $container=$('<div class="fileupload-file"><strong>'+name+'</strong><p>'+human_file_size(file_object.size,true)+'</p><div class="fileupload-file-remove"><span>Fjern <i class="fa fa-times"></i></span></div>'+inner_warning+'</div>');var $button=$('<button style="display: none;">x</button>');$container.append($button);data.context=$button;$button.click(function(){data.submit()});$('#fileupload-files-inner').append($container)}else{var error=[{'text':'<p>Filtypen \'.'+this_filetype+'\' er ikke godkjent på Youkok2. Dersom du syntes denne filtypen burde godkjennes, kan du ta kontakt.</p>','type':'danger',},];display_message(error)};num_of_files=$('.fileupload-file').length-1},done:function(e,data){num_of_files_uploaded++;if(num_of_files_uploaded==num_of_files){window.location.reload()}},progressall:function(e,data){var progress=parseInt(division(data.loaded,data.total)*100,10);$('#progress .bar').css('width',progress+'%')},});$('#archive-create-file-form').on('submit',function(){$('#fileupload-files-inner button').each(function(){$(this).trigger('click')});$('#archive-create-file-form-submit').html('Laster opp....').prop('disabled',true);return false});$('#fileupload-files').on('click','.fileupload-file-remove',function(){$(this).parent().remove()});if($('#archive_accepted_filetypes').length>0){accepted_filetypes=jQuery.parseJSON($('#archive_accepted_filetypes').html());accepted_fileendings=jQuery.parseJSON($('#archive_accepted_fileendings').html())};$('#archive-create-link').on('click',function(){if($('#archive-create-link-div').is(':visible')){$('#archive-create-link-div').stop().slideUp()}else{$('#archive-create-link-div').stop().slideDown(400,function(){$('archive-create-link-url').focus()});$('#archive-create-file-div').stop().slideUp();$('#archive-create-folder-div').stop().slideUp()}});$('#archive-create-link-div a').on('click',function(e){e.preventDefault();$('#archive-create-link-div').stop().slideUp(400,function(){$('#archive-create-link-url').val('');$('#archive-create-link-name').val('')})});var submitting_archive_create_link_form=false;$('#archive-create-link-form').on('submit',function(){var link_name=$('#archive-create-link-url').val();if(link_name.length==0){display_message([{'text':'Du har ikke skrevet inn noen URL.','type':'danger'}])}else{if(!check_url(link_name)){display_message([{'text':'\''+link_name+' \' er ikke en gyldig URL.','type':'danger'}])}else{if(!submitting_archive_create_link_form){submitting_archive_create_link_form=true;$('#archive-create-link-form-submit').html('Jobber...').prop('disabled',true);$.ajax({cache:false,type:"post",url:"processor/create/link",data:{id:$('#archive-id').val(),url:$('#archive-create-link-url').val(),name:$('#archive-create-link-name').val()},success:function(json){submitting_archive_create_link_form=false;if(json.code==200){window.location.reload()}else if(json.code==400){display_message([{'text':'Et element med denne URLen finnes fra før!','type':'danger'}]);$('#archive-create-link-form-submit').html('Lagre').prop('disabled',false)}else{display_message([{'text':'Noe gikk visst galt her!','type':'danger'}]);$('#archive-create-link-form-submit').html('Lagre').prop('disabled',false)}}})}}};return false});if($('#archive-history').length>0){$.ajax({cache:false,type:"post",url:"processor/history/get",data:{id:$('#archive-id').val()},success:function(json){$('#archive-history-inside').html(json.html)}})};$('#main_messages').on('click','.alert-close',function(){$(this).parent().fadeOut(400,function(){$(this).remove()})});if($('.alert').length>0){setTimeout(function(){$('.alert-close').trigger('click')},10000)};$('#archive-context-new-flag-name').on('click',function(e){e.preventDefault();$('#modal-new-flag .modal-title').html('Endre navn på: '+$archive_right_click.data('name'));if($archive_right_click.data('type')=='dir'){$('#modal-new-flag-name .input-group .input-group-addon').html(' ')}else{var filetype_index=$archive_right_click.data('name').lastIndexOf('.');$('#modal-new-flag-name .input-group .input-group-addon').html($archive_right_click.data('name').substr(filetype_index))};$('#modal-new-flag').modal('show');$('.modal-new-flag-container').hide();$('#modal-new-flag-name').show()});$('#modal-new-flag-name-form').on('submit',function(){if($('#modal-new-flag-name-name').val().length==0){alert('Du glemte å skrive inn et navn...')}else{$.ajax({cache:false,type:"post",url:"processor/flag/name",data:{id:$archive_right_click.data('id'),name:$('#modal-new-flag-name-name').val(),filetype:$('#modal-new-flag-name .input-group .input-group-addon').html(),comment:$('#modal-new-flag-name-comment').val()},success:function(json){if(json.code==200){window.location.reload()}else{alert('Noe gikk visst galt her!')}}})};return false});$('#archive-context-new-flag-delete').on('click',function(e){e.preventDefault();$('#modal-new-flag .modal-title').html('Sletting av: '+$archive_right_click.data('name'));$('#modal-new-flag').modal('show');$('.modal-new-flag-container').hide();$('#modal-new-flag-delete').show()});$('#modal-new-flag-delete-form').on('submit',function(){$.ajax({cache:false,type:"post",url:"processor/flag/delete",data:{id:$archive_right_click.data('id'),comment:$('#modal-new-flag-delete-comment').val()},success:function(json){if(json.code==200){window.location.reload()}else{alert('Noe gikk visst galt her!')}}});return false});$('#dropdown-menu-opener').on('click',function(e){setTimeout(function(){$('#login-email').focus()},100)});$('.login-opener').on('click',function(e){e.preventDefault();e.stopPropagation();$('#login-dropdown').dropdown('toggle');setTimeout(function(){$('#login-email').focus()},100)});var profile_email_value="";$('#profile-edit-info-form input').on('keyup',function(){var $that=$(this);var $that_parent=$that.parent();var element_id=this.id;if(this.id=='register-form-email'){if(check_email($that.val())){if($that_parent.hasClass('has-error')){$that_parent.removeClass('has-error')};$('#register-form-email-error1').css('color','');if(profile_email_value!=$('#register-form-email').val()){profile_email_value=$('#register-form-email').val();$.ajax({cache:false,type:"post",url:"processor/register/check",data:{email:$('#register-form-email').val(),ignore:true},success:function(json){if(json.code==200){$('#register-form-email-error2').css('color','')}else{$('#register-form-email-error2').css('color','red')}}})}}else{if(!$that_parent.hasClass('has-error')){$that_parent.addClass('has-error')};$('#register-form-email-error1').css('color','red')}}});if($('#archive-sidebar-newest-inner').length>0){$.ajax({cache:false,url:'graybox/newest',success:function(html){$('#archive-sidebar-newest-inner').html(html);$('#archive-sidebar-newest-inner .moment-timestamp').each(function(){$that=$(this);$that.html(moment($(this).data('ts')).fromNow())})}})};if($('#archive-sidebar-last-downloads-inner').length>0){$.ajax({cache:false,url:'graybox/downloads',success:function(html){$('#archive-sidebar-last-downloads-inner').html(html);$('#archive-sidebar-last-downloads-inner .moment-timestamp').each(function(){$that=$(this);$that.html(moment($(this).data('ts')).fromNow())})}})};if($('#archive-sidebar-numbers-inner').length>0){$.ajax({cache:false,url:'graybox/numbers',success:function(html){$('#archive-sidebar-numbers-inner').html(html)}})};$('.list-group-item a').tooltip();var removing_fav=false;$('.star-remove').on('click',function(){$el=$(this);if(!removing_fav){removing_fav=true;$.ajax({cache:false,type:"post",url:"processor/favorite/remove",data:{id:$el.data('id')},success:function(json){if(json.code==200){$el.parent().slideUp(function(){$(this).remove();if($('#favorites-list li').length==0){$('#favorites-list').html('<li class="list-group-item" style="display: none;"><em>Du har ingen favoritter...</em></li>');$('#favorites-list li').slideDown()};removing_fav=false});display_message(json.msg)}else{alert('Noe gikk visst galt her. Ups!');removing_fav=false}}})}});var popularity_chart=null;var popularity_chart_options=null;$('#archive-context-info').on('click',function(e){e.preventDefault();$('#modal-info .modal-title').html('Detaljer for: '+$archive_right_click.data('name'));$('#modal-info').modal('show');$.ajax({cache:false,type:"post",url:"processor/element/info",data:{id:archive_id},success:function(json){if(json.code==200){$('#info-panel').html(json.html);$('#info-panel .moment-timestamp').html(moment($('#info-panel .moment-timestamp').data('ts')).fromNow());popularity_chart_options.series[0].data=[];if(popularity_chart!==null){popularity_chart.destroy()};var data_dirty=jQuery.parseJSON($('#modal-info-graph-data').html());var data_clean=[];for(var i=0;i<data_dirty.length;i++){data_clean.push([eval(data_dirty[i][0]),parseInt(data_dirty[i][1],10)])};popularity_chart_options.series[0].data=data_clean;popularity_chart=new Highcharts.Chart(popularity_chart_options)}else{$('#modal-info').modal('hide');alert('Noe gikk galt under lastingen av detaljer.')}}})});popularity_chart_options={chart:{renderTo:'modal-info-graph',height:150,width:558,},title:{text:'',style:{display:'none'}},xAxis:{type:'datetime',dateTimeLabelFormats:{month:'%e. %b',year:'%b'},},yAxis:{min:0,title:{enabled:false,},},tooltip:{headerFormat:'<b>Antall totale nedlastninger</b><br>',pointFormat:'{point.x:%e. %b %Y}: {point.y:.0f}'},legend:{enabled:false},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null}},series:[{name:'Populæritet',data:[],}]};$('#toggle-queries').on('click',function(e){e.preventDefault();var $that=$(this);if($('#queries').is(':visible')){$('#queries').slideUp(400,function(){$('span',$that).html('Vis')})}else{$('#queries').slideDown(400,function(){$('span',$that).html('Skjul')})}})})